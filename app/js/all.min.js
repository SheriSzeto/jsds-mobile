!function(){"use strict";document.addEventListener("DOMContentLoaded",function(){var t=document.documentElement,e=t.clientWidth;t.style.fontSize=e/7.2+"px",console.log(t.style.fontSize)},!1)}();
"use strict";var app=angular.module("app",["ui.router","ngDialog"]);app.run(["$rootScope","$state","$stateParams",function(t,r,e){t.$state=r,t.$stateParams=e}]),app.config(["$stateProvider","$urlRouterProvider",function(t,r){r.otherwise("/product"),t.state("/product",{url:"/product",templateUrl:"pages/product/product.html"}).state("/cart",{url:"/cart",templateUrl:"pages/cart/cart.html"}).state("/user",{url:"/user",templateUrl:"pages/user/user.html"}).state("/booking",{url:"/booking",templateUrl:"pages/booking/booking.html"}).state("/orders",{url:"/orders",templateUrl:"pages/orders/orders.html"})}]);
app.factory("$common",["$q",function(t){var e={};e.getMenu=[{name:"服务项目",img:"project",path:"/product",active:!0},{name:"购物车",img:"cart",path:"/cart",active:!1},{name:"我的订单",img:"myorder",path:"/user",active:!1}],e.getGPSPosition=function(){var e=t.defer(),r=new BMap.Geolocation,a=new BMap.Geocoder;return r.getCurrentPosition(function(t){this.getStatus()==BMAP_STATUS_SUCCESS?a.getLocation(t.point,function(t){var r=t.addressComponents,a=r.district+r.street;e.resolve(a)}):alert("failed"+this.getStatus())},{enableHighAccuracy:!0}),e.promise};var r;return e.createCode=function(){r="";for(var t=new Array(0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"),e=0;e<4;e++){var a=Math.floor(52*Math.random());r+=t[a]}return r},e}]);
app.controller("indexCtrl",["$scope","$state","$common",function(e,t,n){e.menus=n.getMenu,e.route=function(n){e.menus.forEach(function(e){e.active=!1}),n.active=!0,"我的订单"==n.name&&(n.path=sessionStorage.getItem("username")?"/orders":n.path),t.go(n.path)}}]);
app.controller("bookingCtrl",["$scope",function(e){e.gender=0,e.hasRead=!0,e.initTime=function(){for(var e=[],t=[],a=0;a<24;a++){var n=a<10?"0"+a+":00":a+":00";t.push(n)}var l=[[{values:function(t,a,n){"number"==typeof t&&(n=a,a=t,t=new Date);for(var l=new Date(t),r=0;r<=a;r++){var o=null;if(n)o=parseInt(l.getMonth()+1)<10?l.getDate()<10?"0"+parseInt(l.getMonth()+1)+"月0"+l.getDate()+"日":"0"+parseInt(l.getMonth()+1)+"月"+l.getDate()+"日":l.getDate()<10?parseInt(l.getMonth()+1)+"月0"+l.getDate()+"日":parseInt(l.getMonth()+1)+"月"+l.getDate()+"日";else{var s=n;s=s.replace(/y{4}/,l.getFullYear()),s=s.replace(/M{2}/,l.getMonth()+1),s=s.replace(/d{2}/,l.getDate()),o=s}e.push(o),l.setDate(l.getDate()+1)}return e}(30,"yyyy年MM月dd日"),label:"服务日期"}],[{values:t,label:"服务时间"}]],r=l[0][0].values[1],o=l[1][0].values[1];console.log(r+","+o),$("#orderTime").mobiscroll().scroller({theme:"mobiscroll",display:"inline",lang:"zh",showLabel:!0,rows:1,wheels:l,defaultValue:[r,o]})},e.getSex=function(t){e.gender=t},e.test=function(){e.hasRead?e.hasRead=!1:e.hasRead=!0},e.initTime()}]);
app.controller("cartCtrl",["$scope","$state",function(t,o){t.isExistServeMsg=!1,t.setMsg=function(){o.go("/booking")}}]);
app.controller("orderCtrl",["$scope","ngDialog",function(e,t){e.orderList=[{name:"李师傅",orderdate:"2015-06-27",period:"10:00-11:00",totalprice:"66",orderstate:0},{name:"李师傅",orderdate:"2015-04-23",period:"10:00-11:00",totalprice:"66",orderstate:1}],e.contact=function(){t.open({template:"contact.html",className:"ngdialog-theme-default ngdialog-theme-dadao"})}}]);
app.controller("productCtrl",["$scope","$common",function(i,e){i.products=[{img:"img/p1.png",name:"健康沐足",part:"颈部-肩部-腿部",account:1668,originprice:88,newprice:66,period:60},{img:"img/p2.png",name:"91至尊沐足",part:"颈部-肩部-腿部",account:3204,originprice:128,newprice:108,period:60},{img:"img/p3.png",name:"办公室肩颈",part:"颈部-肩部-腿部",account:2103,originprice:128,newprice:108,period:60},{img:"img/p4.png",name:"亚健康推拿",part:"颈部-肩部-腿部",account:1345,originprice:88,newprice:66,period:60},{img:"img/p5.png",name:"91全身推拿",part:"颈部-肩部-腿部",account:1783,originprice:168,newprice:128,period:60},{img:"img/p6.png",name:"全身经络排毒",part:"颈部-肩部-腿部",account:1523,originprice:228,newprice:198,period:120},{img:"img/p7.png",name:"美颜排毒理疗",part:"颈部-肩部-腿部",account:1442,originprice:188,newprice:148,period:90}],i.currentPosition="正在定位...",e.getGPSPosition().then(function(e){i.currentPosition=e}),i.addCart=function(i,e){if(!e.disabled||1!=e.disabled){var n=i.target,r=$(".cart").offset(),t=$(n),p=t.parentsUntil("#main",".projectDetail").find(".pImg").attr("src");$('<img class="u-flyer" src="'+p+'">').fly({start:{left:event.pageX,top:event.pageY},end:{left:r.left+10,top:r.top+10,width:0,height:0},onEnd:function(){e.disabled=!0,t.css("cursor","not-allowed").addClass("haveAdd").html("已添加"),this.destory()}})}}}]);
app.controller("userCtrl",["$scope","$common","ngDialog","$state",function(o,e,n,c){o.form={},o.changeCode=function(){o.code=e.createCode()},o.login=function(e){e&&(o.form.smscode.toLowerCase()==o.code.toLowerCase()?c.go("/orders"):n.open({template:"<p>验证码输入错误!</p>",plain:!0}))},o.changeCode()}]);